<!DOCTYPE html>

<html class="writer-html5" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<link href="../../../../img/favicon.ico" rel="shortcut icon"/>
<title>Soti MobiControl - MojPalac</title>
<link href="../../../../css/theme.css" rel="stylesheet"/>
<link href="../../../../css/theme_extra.css" rel="stylesheet"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" rel="stylesheet"/>
<script>
        // Current page data
        var mkdocs_page_name = "Soti MobiControl";
        var mkdocs_page_input_path = "programming/tools/SotiMobiControl/SotiMobiControl.md";
        var mkdocs_page_url = null;
      </script>
<!--[if lt IE 9]>
      <script src="../../../../js/html5shiv.min.js"></script>
    <![endif]-->
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
<script>hljs.highlightAll();</script>
</head>
<body class="wy-body-for-nav" role="document">
<div class="wy-grid-for-nav">
<nav class="wy-nav-side stickynav" data-toggle="wy-nav-shift">
<div class="wy-side-scroll">
<div class="wy-side-nav-search">
<a class="icon icon-home" href="../../../.."> MojPalac
        </a><div role="search">
<form action="../../../../search.html" class="wy-form" id="rtd-search-form" method="get">
<input aria-label="Search docs" name="q" placeholder="Search docs" title="Type search term here" type="text"/>
</form>
</div>
</div>
<div aria-label="Navigation menu" class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation">
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../..">MojPalac</a>
</li>
</ul>
<p class="caption"><span class="caption-text">Books</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../books/android_programing_big_nerd_ranch/">Android Programming Big Nerd Ranch</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../books/pragmatic_programmer/">Pragmatic programmer</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../books/rozwoj_w_dwoch_jezykach/">Rozwoj w Dwoch jezykach</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="#">Kotlin coroutines</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../books/kotlin_coroutines/analogy/">kotlin coroutines analogy</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../books/kotlin_coroutines/kotlin_coroutines/">Kotlin Coroutines Deep Dive</a>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Hobbies</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../hobbies/pool/">Pool</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../hobbies/tennis/">Grip</a>
</li>
</ul>
<p class="caption"><span class="caption-text">Programming</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../architecture/">Architecture</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../ascii/">ASCII</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../c/">C</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../markdown/">Markdown</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../mkdocs/">MKDocs</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../notes/">Notes</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../solid/">SOLID principles</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../testing/">Unit Testing</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../third_party_library/">3rd Party library</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="#">Android</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../../android/AndroidManifest/">AndroidManifest.xml</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../android/UITesting/">UITesting</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../android/notes/">Notes</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../android/storage/">Storage</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../android/threading/">Threading</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../android/views/">Views</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#">Courses</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="#">Algorithms</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="../../../courses/algorithms/algorithms/">Princeton university algorithms part 1</a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#">Kotlin</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../../kotlin/coroutines/">Coroutines</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../kotlin/kotlin/">Kotlin</a>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal current" href="#">Tools</a>
<ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../bugsnag/">Bugsnag</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../git/">Git</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../terminal/">Terminal comments</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../vim/">Vim</a>
</li>
<li class="toctree-l2 current"><a class="reference internal current" href="#">SotiMobiControl</a>
<ul class="current">
<li class="toctree-l3 current"><a class="reference internal current" href="./">Soti MobiControl</a>
<ul class="current">
<li class="toctree-l4"><a class="reference internal" href="#modes">Modes</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#android-11-access-external-storage-solutions">Android 11 access external storage solutions</a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Work</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../work/JustEatIdeas/">JustEatTakeaway Ideas</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../work/ReceiveOrderStructureRefactor/">Receive Order Structure</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../work/goals/">Goals</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../work/interviewQuestions/">Candidate questions</a>
</li>
</ul>
</div>
</div>
</nav>
<section class="wy-nav-content-wrap" data-toggle="wy-nav-shift">
<nav aria-label="Mobile navigation menu" class="wy-nav-top" role="navigation">
<i class="fa fa-bars" data-toggle="wy-nav-top"></i>
<a href="../../../..">MojPalac</a>
</nav>
<div class="wy-nav-content">
<div class="rst-content"><div aria-label="breadcrumbs navigation" role="navigation">
<ul class="wy-breadcrumbs">
<li><a aria-label="Docs" class="icon icon-home" href="../../../.."></a> »</li>
<li>Programming »</li>
<li>Tools »</li>
<li>SotiMobiControl »</li>
<li class="breadcrumb-item active">Soti MobiControl</li>
<li class="wy-breadcrumbs-aside">
</li>
</ul>
<hr/>
</div>
<div class="document" itemscope="itemscope" itemtype="http://schema.org/Article" role="main">
<div class="section" itemprop="articleBody">
<h1 id="soti-mobicontrol">Soti MobiControl</h1>
<h2 id="modes">Modes</h2>
<h3 id="dev-mode">Dev Mode</h3>
<p>[AE]-[All]-[Orderpad]-[UK]-[All]-[CFG]-[All]-Security_WorkManaged  - remove
[AE]-[Live]-[Orderpad]-[All]-[All]-[CFG]-[All]-Restrictions - remove</p>
<h2 id="android-11-access-external-storage-solutions">Android 11 access external storage solutions</h2>
<p>With Android 11 apps can't access easily external storage (sd card).
This change was introduce to increase protection of the user. <br/>
Problem - all files that are used by JET e.g. <code>deviceInfo.ini</code> (this one is used to get IMEI), <code>OrderPad.log.0</code> are
stored on sd card.
Which means devices that are running on Android 11 and above can't access those files by default.</p>
<h3 id="1-force-the-permission-via-soti-mobicontrol">1. Force the permission via SOTI mobicontrol:</h3>
<p>note: All cases described below where completed with permission added to the <code>AndroidManifest.xml</code>: <br/>
<code>&lt;uses-permission android:name="android.permission.MANAGE_EXTERNAL_STORAGE" /&gt;</code></p>
<p><strong>1.1.</strong></p>
<p>Josh from The SOTI team gave as below instruction how can we achieve it:<br/>
<code>afw_set_permission_grant_state com.justeat.orderpad android.permission.MANAGE_EXTERNAL_STORAGE allow</code></p>
<p>unfortunately it didn't resolve the problem as permission wasn't granted:<br/>
<img alt="first_try.png" src="../first_try.png"/></p>
<p><strong>1.2.</strong></p>
<p>Second solution from Josh was to try the below one:<br/>
<code>request_appops_permission android.permission.MANAGE_EXTERNAL_STORAGE allow com.justeat.orderpad</code></p>
<p><img alt="script_usage.png" src="../script_usage.png"/></p>
<p>Same result, it didn't work.</p>
<p><strong>1.3.</strong></p>
<p>below works locally via terminal: <br/>
<code>adb shell appops set com.justeat.orderpad MANAGE_EXTERNAL_STORAGE allow</code></p>
<p>so I tried to adjust the package from 1.2 and also tried: <br/>
<code>request_appops_permission MANAGE_EXTERNAL_STORAGE allow com.justeat.orderpad</code>
though it didn't work either.</p>
<h4 id="summary">summary</h4>
<p>Explanation from Josh why it's not working:</p>
<p><em>In order for MobiControl to have the ability to grant other apps any kind of special permissions, we need access to
API’s which Samsung do not offer. For other manufacturers we often work around this with the MobiControl agent plugin,
but for Samsung this doesn’t exist. I was hoping that one of the two scripts may have still worked but given the
information I’ve found since Nic’s first email, these would never have worked on a Samsung device running Android 11.</em></p>
<p><em>Having further researched, it seems other customers have made the same request and have been unable to come to a
workable solution.</em></p>
<p><em>It seems the only way which might be possible to get Orderpad to have the permission, is to embed the permission
request into the app installation.</em></p>
<p>to check:</p>
<ul>
<li>I asked Josh for clarification what he mean by <em>embed the permission request into the app installation</em></li>
</ul>
<h3 id="2-using-app-specific-external-storage">2. Using app specific external storage</h3>
<p>This approach rather than trying to get the required permission is taking advantage of the available solution that was
introduced in Android 11.
Each application has access to its own storage (path) inside sd card if required. This doesn't require any permission to
be acquired from the user.
This solution does work in terms of creating logs on sd card under the directory:
<code>/sdcard/Android/data/com.justeat.orderpad/files/OrderPad.log.0</code> which is accessible by app.</p>
<p>The downside is that files in this directory aren't accessible by SOTI MobiControl.</p>
<p><img alt="soti_not_accessible_storage.png" src="../soti_not_accessible_storage.png"/></p>
<p>Which means:</p>
<ul>
<li>we can't download the logs file via SOTI MobiControl (TO CONFIRM WITH JOSH)</li>
</ul>
<p>To check:</p>
<ul>
<li>can we put files there via SOTI (when app is added to distribution) instead of putting them in the root of SD card? -
  Nic asked question to Josh</li>
<li>is there a different way for us to get the logs instead of via SOTI? like pushing it to some server/tool</li>
</ul>
<h3 id="3-getting-permission-from-the-user">3. Getting permission from the user</h3>
<p>We can request a permission from the user in runtime, though because it's not standard permission but <a href="https://developer.android.com/guide/topics/permissions/overview#special">special
permission</a> thus it can't grant directly in the
app, but rather through system settings, as described
in <a href="https://developer.android.com/training/permissions/requesting-special">documentation</a> <br/>
Once requested the permission (we can define when it's going to happen), we are going to show below screen:</p>
<p><img alt="user_permission_request.png" src="../user_permission_request.png"/></p>
<p>Once user grands permission we have access to external storage.</p>
<p>to check:</p>
<ul>
<li>is there a way for us to show and switch the toggle via SOTI MobiControl?</li>
</ul>
<h3 id="4-shared-media-storage">4. Shared Media Storage</h3>
<p>It would be probably achieve it via Shared Media Storage, but it requires user interaction for selecting the proper
destination (granting permission for it) - per <a href="https://developer.android.com/training/data-storage/shared/documents-files#grant-access-directory">documentation</a>.
So similarly to 3. but more prone to error as user needs to select the proper directory.</p>
</div>
</div><footer>
<div aria-label="Footer Navigation" class="rst-footer-buttons" role="navigation">
<a class="btn btn-neutral float-left" href="../../vim/" title="Vim"><span class="icon icon-circle-arrow-left"></span> Previous</a>
<a class="btn btn-neutral float-right" href="../../../../work/JustEatIdeas/" title="JustEatTakeaway Ideas">Next <span class="icon icon-circle-arrow-right"></span></a>
</div>
<hr/>
<div role="contentinfo">
<!-- Copyright etc -->
</div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
</div>
</div>
</section>
</div>
<div aria-label="Versions" class="rst-versions" role="note">
<span class="rst-current-version" data-toggle="rst-current-version">
<span><a href="../../vim/" style="color: #fcfcfc">« Previous</a></span>
<span><a href="../../../../work/JustEatIdeas/" style="color: #fcfcfc">Next »</a></span>
</span>
</div>
<script src="../../../../js/jquery-3.6.0.min.js"></script>
<script>var base_url = "../../../..";</script>
<script src="../../../../js/theme_extra.js"></script>
<script src="../../../../js/theme.js"></script>
<script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
<script src="../../../../search/main.js"></script>
<script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>
</body>
</html>
